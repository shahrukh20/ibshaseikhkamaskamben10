@model CustomerManagementSystem.BLL.ViewModels.LeadPoolsViewModel
@{
    ViewBag.Title = "LeadAddition";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<script src="~/js/libs/jquery-2.1.1.min.js"></script>
<script src="~/js/libs/jquery-ui-1.10.3.min.js"></script>

<link href="~/Content/jsgrid/jsgrid.min.css" rel="stylesheet" />
<link href="~/Content/jsgrid/jsgrid-theme.min.css" rel="stylesheet" />
<link href="~/css/font-awesome.min.css" rel="stylesheet" />
<script src="~/Content/jsgrid/jsgrid.min.js"></script>
@*<style>
        .img-wrap {
            position: relative;
            display: inline-block;
            /*border: 1px red solid;*/
            font-size: 0;
        }

            .img-wrap .close {
                position: absolute;
                top: 2px;
                right: 2px;
                z-index: 100;
                background-color: #FFF;
                padding: 5px 2px 2px;
                color: #000;
                font-weight: bold;
                cursor: pointer;
                opacity: 1.2;
                text-align: center;
                font-size: 22px;
                line-height: 10px;
                border-radius: 50%;
                margin-top: 15px;
            }

            .img-wrap:hover .close {
                opacity: 1;
            }
    </style>*@

<form id="leadForm" action="/LeadPools/ViewLead" method="post">
    @Html.EditorFor(model => model.id, new { htmlAttributes = new { @class = "form-control", @style = "display:none" } })
    <div id="content">

        <div class="form-horizontal">

            <div class="form-group">
                <div class="col-lg-10">
                    <h2>Log New Lead</h2>
                </div>
                <div class="col-lg-2">
                    <h2>
                        <h2arabic>
                            مرفقات
                        </h2arabic>
                    </h2>
                </div>
            </div>
            <div class="form-group">
                <div class="">
                    <div class="col-md-10">
                        <h2>Lead Information</h2>
                    </div>
                    <div class="col-md-2">
                        <h5>
                            <h5arabic>
                                سجل جديد الرصاص
                            </h5arabic>
                        </h5>
                    </div>

                </div>
            </div>
            <div class="form-group">
                <div class="col-md-1">
                    <label class="control-label">Log#:</label>
                </div>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.id, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })

                </div>
                <label class="col-md-2">
                    سجل لا:
                </label>

                <label class="col-md-1">
                    Date:
                </label>

                <div class="col-md-3">
                    @Html.EditorFor(model => model.txtDate, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })

                </div>
                <label class="col-md-2">
                    تاريخ
                </label>
            </div>
            <div class="form-group">

                <label class="col-md-1">
                    Budget:
                </label>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.txtbudget, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                    @*<input type="number" id="txtbudget" name="txtbudget" class="form-control" />*@
                </div>
                <label class="col-md-1">
                    ميزانية
                </label>


            </div>
            <div class="form-group">
                <label class="col-md-1">
                    Name:
                </label>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.txtLeadName, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                    @*<input type="text" id="txtLeadName" name="txtLeadName" class="form-control" />*@
                </div>
                <label class="col-md-2">
                    اسم الرصاص
                </label>
                <label class="col-md-1">
                    Contact:
                </label>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.txtContactPerson, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                    @*<input type="text" id="txtContactPerson" name="txtContactPerson" class="form-control" />*@
                </div>
                <label class="col-md-2" style="">
                    الشخص الذي يمكن الاتصال به
                </label>
            </div>
            <div class="form-group">
                <label class="col-md-1">
                    Designation:
                </label>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.txtDesignation, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                    @*<input type="text" id="txtDesignation" name="txtDesignation" class="form-control" />*@
                </div>
                <label class="col-md-2">
                    تعيين
                </label>
                <label class="col-md-1 control-label">
                    Telephone:
                </label>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.txtTel, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                    @*<input type="text" id="txtTel" name="txtTel" class="form-control" />*@
                </div>
                <label class="col-md-2">
                    هاتف
                </label>

            </div>
            <div class="form-group">
                <label class="col-md-1">
                    Fax:
                </label>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.txtFax, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                    @*<input type="text" id="txtFax" name="txtFax" class="form-control" />*@
                </div>
                <label class="col-md-2">
                    فاكس
                </label>
                <label class="col-md-1">
                    Email:
                </label>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.txtEmail, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                    @*<input type="text" id="txtEmail" name="txtEmail" class="form-control" />*@
                </div>
                <label class="col-md-2 ">
                    البريد الإلكتروني
                </label>

            </div>
            <div class="form-group">
                <label class="col-md-1">
                    Source Of Lead:
                </label>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.ddlSourceOfLead, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                    @*@Html.DropDownList("ddlSourceOfLead", (IEnumerable<SelectListItem>)ViewBag.SourceOfLead, new { @class = "form-control select" })*@
                    @*<DropDownList id="" class="form-control"></DropDownList>*@
                </div>
                <label class="col-md-2">
                    مصدر الرصاص
                </label>
                <label class="col-md-1">
                    Source:
                </label>
                <div class="col-md-3">
                    @Html.EditorFor(model => model.txtSource, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })
                    @*<input type="text" id="txtSource" name="txtSource" class="form-control" />*@
                </div>
                <label class="col-md-2">
                    مصدر
                </label>

            </div>
            <div class="form-group">
                <label class="col-md-1">
                    Remarks:
                </label>
                <div class="">
                    @*<input type="text" ID="txtRemarks" TextMode="MultiLine" Rows="3" class="form-control" />*@
                    @*@Html.EditorFor(model => model.txtRemarks, new { htmlAttributes = new { @class = "form-control", @disabled = "disabled" } })*@
                    @Html.EditorFor(model => model.txtRemarks, new { htmlAttributes = new { @class = "col-md-9", @disabled = "disabled" } })
                    @*@Html.EditorFor(model => model.txtRemarks)
                        <textarea name="txtRemarks" id="txtRemarks" cols="25" rows="3" class="col-md-9"></textarea>*@
                </div>
                <label class="col-md-2">
                    ملاحظات
                </label>



            </div>

        </div>
        <div class="form-horizontal">
            <div class="form-group">

                <div class="col-md-10">
                    <a onclick="HideShowRevision()"><h2>Lead Attachments</h2></a>
                    <h5></h5>
                </div>
                <div class="col-md-2">
                    <h5>
                        <h5arabic>
                            مرفقات
                        </h5arabic>
                    </h5>
                </div>


            </div>
        </div>
        <div style="overflow-x:scroll;background: #ccc5c5;height: 163px;">
            <div style="width:100%;height: 120px;border-radius: 12.4px;margin-bottom: 15px;padding: 9px;" class="">

                @{
                    List<string> images = (List<string>)ViewBag.images;
                    if (images != null)
                    {
                        if (images.Count > 0)
                        {
                            foreach (var imageurl in images)
                            {
                                <div class="img-wrap">
                                    <span class=""></span>
                                    <img src="@imageurl" class="pop" style="margin-left: 50px;margin-top:15px;margin-bottom:10px;width: 120px;height:100px;border-radius: 6.4px;" data-id="@imageurl" />
                                </div>

                            }

                        }
                        else
                        {
                            <div style="text-align: center;"><h3 style="color:white">No Images Available</h3></div>
                        }
                    }
                }
            </div>
        </div>
        <div class="form-horizontal">
            <div class="form-group">
                <div class="col-md-offset-10 col-md-3">
                    <button type="submit" class="btn btn-info btn-lg">Cancel</button>
                </div>
            </div>
        </div>
    </div>
</form>


<script type="text/javascript">

    $("#jsGrid").jsGrid({
        width: "100%",
        height: "400px",
        filtering: false,
        editing: false,
        sorting: false,
        paging: true,
        autoload: true,
        pageSize: 5,
        pageButtonCount: 5,

        controller: {


            loadData: function (filter) {
                var id = $("#id").val();
                return $.ajax({
                    type: "POST",
                    data: JSON.stringify({ id: id }),
                    url: "../LeadPools/LoadLeadAttachments?id="+id,
                    dataType: "JSON"
                });
            }
        },
        fields: [
            { name: "id", title: "id", type: "text", visible: false, align: 'center' },
            { name: "Name", title: "Name", type: "text", width: 50, validate: "required", align: 'center', editing: false },
            { name: "Size", title: "Size", type: "text", width: 50, align: 'center', editing: false },
               {
                name: 'Download',
                align: 'center' ,
                itemTemplate: function (_, item) {
                    //return $("<button>").text("Click Me")
                    //    .on("click", function () {
                    //        alert(item.Name);
                    //    });
                    //return "<a href=\"\WorkOrders\WorkOrder?MileStoneId=" + item.Id + "\">link text</a>";
                    return "<a onclick ='DownloadFile(" + item.id +")' name='sds'>Download</a>";
                    //return '@Html.ActionLink("WorkOrders", "WorkOrder", @"WorkOrders\WorkOrder", new { WorkOrders = 1 })';
                }
            }
        ]

    });
</script>
<script>
    function HideShowRevision() {
        var x = document.getElementById("divAttachments");
        if (x.style.display === "none") {
            x.style.display = "block";
        } else {
            x.style.display = "none";
        }
    }
    function DownloadFile(id) {
        $.ajax({
            type: "POST",
            url: "../LeadPools/DownloadFile?id=" + id,
            dataType: "JSON",
            success: function () {
                var base_url = window.location.origin;
                window.location = base_url + "/LeadPools/DownloadFile?id=" + id;
            },
            error: function () {
                var base_url = window.location.origin;
                window.location = base_url + "/LeadPools/DownloadFile?id=" + id;
            }
        });
    }
</script>