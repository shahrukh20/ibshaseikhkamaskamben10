
<script src="/Content/js/plugins/jquery/jquery-3.3.1.js"></script>
<script>
    $.ajax({
        url: "http://ajax.aspnetcdn.com/ajax/jquery.validate/1.8.1/jquery.validate.min.js",
        dataType: "script",
        cache: true,
        success: function () {
            $.ajax({
                url: "https://cdnjs.cloudflare.com/ajax/libs/jquery-validation-unobtrusive/3.2.10/jquery.validate.unobtrusive.js",
                dataType: "script",
                cache: true,
            });
        }
    });
</script>

<script>
    function rtrim(str) {
        return str.replace(/\,$/, '');
    }
    $(document).ready(function () {
        //   $.noConflict();
        $('#images').change(function () {
            var i;
            var names = '';
            for (i = 0; i < $('#images')[0].files.length; ++i) {
                names += $('#images')[0].files[i].name + "  ,  ";
            }
            $('#text').val('')
            $('#text').val(rtrim(names));
        })
    })
</script>
<form id="leadForm" action="/LeadPools/LeadAddition" method="post" class="panel panel-default" enctype="multipart/form-data" novalidate="novalidate">
    <div id="content">

        <div class="form-horizontal">

            <div class="form-group">
                <div class="col-lg-10">
                    <h2>Log New Lead</h2>
                </div>

            </div>
            <div class="form-group">
                <div class="">
                    <div class="col-md-10">
                        <h5>Lead Information</h5>
                    </div>

                </div>
            </div>
        </div>

        @*<div class="form-group">
                <div class="col-md-1">
                    <label class="control-label">Log#:</label>
                </div>
                <div class="col-md-3">
                    <input type="text" id="txtLogNo" name="txtLogNo" class="form-control" />
                </div>
                <label class="col-md-2">
                    سجل لا:
                </label>

                <label class="col-md-1">
                    Date:
                </label>

                <div class="col-md-3">
                    <input type="text" id="txtDate" name="txtDate" class="form-control datepicker" data-mask="99:99" MaxLength="10" />
                </div>
                <label class="col-md-2">
                    تاريخ
                </label>
            </div>*@
        <div class="form-horizontal">
            <div class="form-group">
                <label class="col-md-2">
                    Name:
                </label>
                <div class="col-md-4">
                    <input type="text" id="txtLeadName" name="txtLeadName" class="form-control" data-val="true" data-val-required="The Lead Name is required." required />
                    <span class="field-validation-error text-danger" data-valmsg-for="txtLeadName" data-valmsg-replace="true"></span>
                </div>

            </div>
            <div class="form-group">
                <label class="col-md-2">
                    Property:
                </label>
                <div class="col-md-4">
                    @Html.DropDownList("ddlProperty", (IEnumerable<SelectListItem>)ViewBag.Properties, new { @class = "form-control select" })
                </div>
                <div id="divCampaignMsg" style="color:blue" class="col-md-4">

                </div>


            </div>

            <div class="form-group">
                <label class="col-md-2">
                    Contact Person:
                </label>
                <div class="col-md-4">
                    <input type="text" id="txtContactPerson" name="txtContactPerson" class="form-control" data-val="true" data-val-required="The Lead Name is required." required />
                    <span class="field-validation-error text-danger" data-valmsg-for="txtContactPerson" data-valmsg-replace="true"></span>
                </div>
                <label class="col-md-2">
                    Designation:
                </label>
                <div class="col-md-4">
                    <input type="text" id="txtDesignation" name="txtDesignation" class="form-control" data-val="true" data-val-required="The Designation is required." required />
                    <span class="field-validation-error text-danger" data-valmsg-for="txtDesignation" data-valmsg-replace="true"></span>
                </div>




            </div>
            <div class="form-group">


                <label class="col-md-2">
                    Telephone:
                </label>
                <div class="col-md-4">
                    <input type="text" id="txtTel" name="txtTel" class="form-control" data-val="true" data-val-required="The Telephone is required." required />
                    <span class="field-validation-error text-danger" data-valmsg-for="txtTel" data-valmsg-replace="true"></span>
                </div>

                <label class="col-md-2">
                    Mobile:
                </label>
                <div class="col-md-4">
                    <input type="text" id="txtMobile" name="txtMobile" class="form-control" data-val="true" data-val-required="The Mobile is required." required />
                    <span class="field-validation-error text-danger" data-valmsg-for="txtMobile" data-valmsg-replace="true"></span>
                </div>

            </div>
            <div class="form-group">
                <label class="col-md-2">
                    Fax:
                </label>
                <div class="col-md-4">
                    <input type="text" id="txtFax" name="txtFax" class="form-control" />
                </div>

                <label class="col-md-2">
                    Email:
                </label>
                <div class="col-md-4">
                    <input type="email" id="txtEmail" name="txtEmail" class="form-control" data-val="true" data-val-required="The Email is required." required />
                    <span class="field-validation-error text-danger" data-valmsg-for="txtEmail" data-valmsg-replace="true"></span>
                </div>


            </div>
            <div class="form-group">
                <label class="col-md-2">
                    Source Of Lead:
                </label>
                <div class="col-md-4">
                    @Html.DropDownList("ddlSourceOfLead", (IEnumerable<SelectListItem>)ViewBag.SourceOfLead, new { @class = "form-control select" })
                    <span class="field-validation-error text-danger" data-valmsg-for="ddlSourceOfLead" data-valmsg-replace="true"></span>
                    @*<DropDownList id="" class="form-control"></DropDownList>*@
                </div>

                <label class="col-md-2">
                    Source:
                </label>
                <div class="col-md-4">
                    <input type="text" id="txtSource" name="txtSource" class="form-control" data-val="true" data-val-required="The Source is required." required />
                    <span class="field-validation-error text-danger" data-valmsg-for="txtSource" data-valmsg-replace="true"></span>
                </div>


            </div>
            <div class="form-group">

                <label class="col-md-2">
                    Budget:
                </label>
                <div class="col-md-2">
                    <input type="number" id="txtbudget" name="txtbudget" class="form-control" data-val="true" data-val-required="The Budget field is required." required />
                    <span class="field-validation-error text-danger" data-valmsg-for="txtbudget" data-valmsg-replace="true"></span>
                </div>
                <div class="col-md-2">
                    @Html.DropDownList("ddlCurrency", (IEnumerable<SelectListItem>)ViewBag.Currency, new { @class = "form-control select" })
                </div>


            </div>

            <div class="form-group">

                <label class="col-md-2">
                    Remarks:
                </label>
                <div class="">
                    @*<input type="text" ID="txtRemarks" TextMode="MultiLine" Rows="3" class="form-control" />*@
                    <textarea name="txtRemarks" id="txtRemarks" cols="25" rows="3" class="col-md-8"></textarea>
                </div>


            </div>
        </div>
    </div>
    <div class="form-horizontal">
        <div class="form-group">

            <div class="col-md-10">
                <h5>Lead Attachments</h5>
            </div>



        </div>
    </div>

    @*<div class="form-horizontal">
            <div class="form-group">
                @Html.Partial("../LeadPools/_UploadFiles", null)
            </div>
        </div>*@
    <div class="form-horizontal">
        <hr>

        @*<div class="form-group">
                <label class="control-label col-md-2" for="files">Browse File</label>
                <div class="col-md-10">
                    <input accept="application/msword, application/vnd.ms-excel, application/vnd.ms-powerpoint,text/plain, application/pdf, image/*"
                           data-val-required="Please select file." id="files" multiple="multiple" name="files" type="file" value="">
                    <span class="field-validation-valid text-danger" data-valmsg-for="files" data-valmsg-replace="true"></span>
                </div>
            </div>*@

        <div class="form-group">
            <input type="file" style="display:none" id="images" name="images" multiple>
            <div style="margin-left:-10px" class="col-lg-12">
                <div class="col-lg-offset-2 col-lg-10">
                    <div onclick="$('#images').trigger('click')" class="btn btn-primary btn-sm float-left">
                        <span>Choose files</span>
                    </div>
                    <input class="form-control" type="text" id="text" disabled placeholder="Upload one or images">
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-offset-2 col-md-10 text-success">

            </div>
        </div>

    </div>
    <div class="form-horizontal">
        <div class="form-group">
            <div class="col-md-offset-10 col-md-3">

                <button type="button" onclick="submitform()" class="btn btn-info btn-lg" id="save">Save</button>
                <input id="submit_handle" type="submit" style="display: none">

                @*<button type="submit" class="btn btn-info btn-lg">Save</button>*@
            </div>
        </div>
    </div>

</form>
<script>
    function submitform() {
        if ($("#leadForm").valid()) {
            $('#submit_handle').click();
        }
    }
</script>
<script>
    function PostForm() {
        var str = $("#leadForm").serialize();
        $.ajax({
            type: 'POST',
            url: "/LeadPools/PostForm",
            data: JSON.stringify({ LeadVMJson: str }),
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: false,
            success: function (data) {
                postFiles();
                window.location = "/LeadPools/index";
            },
            Error: function (data) {
                //error msg
            }
        });
    }
    function postFiles() {
        var str = $("#UploadForm").serialize();
        $.ajax({
            type: 'POST',
            data: JSON.stringify({ LeadVMJson: str }),
            url: "/LeadPools/_UploadFiles",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: false,
            success: function (data) {
                window.location = "/LeadPools/_UploadFiles";
                AlertPopUp("Lead Has Been Added");
            },
            Error: function (data) {
            }
        });
    }
    $(function () {
        $(".datepicker").datepicker();
    });
</script>


<script type="text/javascript">
    $("#ddlProperty").change(function () {
        var end = this.value;
        $.ajax({
            type: 'POST',
            data: JSON.stringify({ _id: end }),
            url: "/LeadPools/UpdateLabelForCampaigns",
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            async: false,
            success: function (data) {
                $("#divCampaignMsg").attr("visibility", "visible");
                $('#divCampaignMsg').text(data);
            },
            Error: function (data) {
            }
        });

    });

</script>